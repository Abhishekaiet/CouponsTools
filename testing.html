<!DOCTYPE HTML>
<html>
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
  </head>
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="js/responsive.css">
	  <link rel="stylesheet" type="text/css" href="css/coupons&deals.css">
	  <link rel="stylesheet" type="text/css" href="css/creatingcoupons.css">
	  <link rel="stylesheet" type="text/css" href="css/creatingpage.css">
	  <link rel="stylesheet" type="text/css" href="css/creatingcouponsleftresult.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
				<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
	  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	   <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.9.4/firebase.js"></script>
	<script src="jcrop/jcropdealllocal.js"></script>
	
	<script src="http://deepliquid.com/projects/Jcrop/js/jquery.min.js"></script>
        <script src="http://deepliquid.com/projects/Jcrop/js/jquery.Jcrop.js"></script>
        <link rel="stylesheet" href="http://deepliquid.com/projects/Jcrop/css/jquery.Jcrop.css" type="text/css" />
        <link rel="stylesheet" href="http://deepliquid.com/projects/Jcrop/demos/demo_files/demos.css" type="text/css" />
	
	  
<!--	  <script src="jcrop/jquery.Jcrop.min.js"></script>-->
      <script src="jcrop/jquery.Jcrop.js"></script>
<!--	  <script src="jcrop/jcropdeal2.js"></script>-->
  <body data-rsssl=1>
   
	  
	  <input type="file" id="files" multiple>
	   <output id="result" />
	  <ul id="imagelistlocal"></ul>
	  
	  <div id="viewswebdeal4" style="float: left;"></div>
	  <img src="" id="myImg">
	  <img src="" id="base">
<button id="cropbuttondelweb4" type="button">Apply Crop</button>
	  
	  <button id="submitcroppdelsweb4" type="button" style="width: 30%;
    height: 40px;
    font-size: 20px;
    /* background: #1289e0; */
    border: 1px solid;
    background: none;
    margin-left: 0%;
    margin-top: 36%;
    color: #000000;
    border-radius: 30px;">submit</button>
	  

	  <button type="button" id="cropdealsright">Get Image in to cropmodal</button>
	  <button type="button" id="uploadtheimage">Upload image</button>
	  <button type="button" id="delte">Delete</button>
	  
<ul id="sliderlist"></ul>
	  
	  <img src="" id="imagedata">
	  
	  <style>
	  
		#imagelistlocal
		  {
			  list-style: none;
			  
		  }
		  
	  </style>
	  
	  <script>
		  
		  
		  		 // Initialize Firebase
  var config = {
    apiKey: "AIzaSyCFgW7VCEKkko_t42HBjXBL0guNmJgl-94",
    authDomain: "mycommunity-a734d.firebaseapp.com",
    databaseURL: "https://mycommunity-a734d.firebaseio.com",
    projectId: "mycommunity-a734d",
    storageBucket: "mycommunity-a734d.appspot.com",
    messagingSenderId: "885464413077"
  };
  firebase.initializeApp(config);
	  
		  var filesforcroplocal;
		  var arraylistfile = [];
		  var arraylistposremoving = [];
		  
		 var  imageobject;
		  imageobject = [];
		  
		  
		  
		 window.onload = function(){
    //Check File API support
    if(window.File && window.FileList && window.FileReader)
    {	
		
        var filesInput = document.getElementById("files");
        
        filesInput.addEventListener("change", function(event){ 
            
            var files = event.target.files; //FileList object
            var output = document.getElementById("result");
           
			
            for(var i = 0; i< files.length; i++)
            {
                var file = files[i];
				
				
				   
				arraylistfile.push(file);
                
                //Only pics
                if(!file.type.match('image'))
                  continue;
                
                var picReader = new FileReader();
                
				const filedata = file;
				const pos = i;
				
                picReader.addEventListener("load",function(event){
                    
                    var picFile = event.target;
					
					console.log(picFile);
                    
					const pacefile =  event.target;	
					
		var ul = document.getElementById("imagelistlocal");
		var li = document.createElement('li');			
        li.innerHTML='<div style="width: 180px; height: 126px; float:left; margin-left:20px; margin-top:10px;"><img src='+picFile.result+' style="float:left; width: 180px; margin-top: 10px; height: 126px; object-fit: cover; margin-left: 3%; position: relative;" id="photosearchlist"><div style="width: 180px; height: 126px; background:#2b24248c; margin-top: 10px; position: relative; margin-left: 6px; z-index: 2;"><input type="checkbox" style="position: absolute;right: 10px;"></div>'+filedata+'</div>';
        ul.appendChild(li);
					
					li.addEventListener('click',dealslocalmutiple);
									
									function dealslocalmutiple()
									{
										
										console.log(pos);
										
//										arraylistposremoving.push(pos);
										
//										filesforcroplocal = filedata;
										
									
								
									}
                    
//                    output.insertBefore(div,null);            
                
                });
                
                 //Read the image
                picReader.readAsDataURL(file);
				
				
            }                               
           
        });
    }
    else
    {
        console.log("Your browser does not support File API");
    }
}
		 
		 
		 
	document.getElementById('uploadtheimage').addEventListener('click',function(){
		
		console.log(arraylistfile);
	
		  for(var i = 0; i< arraylistfile.length; i++)
            {
                var imageFile = arraylistfile[i];
				
				console.log(imageFile);
				
				   uploadImageAsPromise(imageFile);
				
			}
		
		
		//Handle waiting to upload each file using promise
function uploadImageAsPromise (imageFile) {
    return new Promise(function (resolve, reject) {
		var storageRef =firebase.storage().ref("/dealimageupload/"+imageFile.name);
		

     		//put request upload file to firebase storage
  storageRef.put(imageFile).then(function(url) {
	  
    console.log('image has been uploaded googli!');
	  
	  
	 var urlPromise = storageRef.getDownloadURL();
	  urlPromise.then(url => {
						
							 
		const dataurl = url;
		  
		   console.log(dataurl);
		  
		   imageobject.push(dataurl);
		
						
					});
	  });
		
    });
}
		
		
	});
    
		document.getElementById('delte').addEventListener('click',function(){
			
			
		
														  })  
		  
		  
	  </script>
	  
	  
	 